import{o as e,v as H}from"./chunk-IR6S3I6Y-DmKRdMYR.js";import{g as B,U as F,l as K,a as U}from"./update-thread-dialog-KHqC5pOF.js";import{A as q}from"./avatar-BJvGI2je.js";import{u as v,t as c,B as x,P as E}from"./QueryClientProvider-Y79vg6s4.js";import{u as g,a as h,i as m,I as p}from"./api-C3WgiByt.js";import{D as M,a as Q,b as R,d as $,e as N,f as z,C as O,i as V,j as _,g as W,k as Y,l as Z}from"./thread.schema-DDD88C0L.js";import{T as o}from"./text-DPDxdRnU.js";import{u as G}from"./authStore-BusQRGVs.js";import{B as d}from"./box-Dg76m1IB.js";import{F as J}from"./flex-BUJ8Rvdc.js";import{H as C}from"./h-stack-CzZcGfDb.js";import{S as X}from"./show-BT0EsfZw.js";const ee="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M8.5%2019H8C4%2019%202%2018%202%2013V8C2%204%204%202%208%202H16C20%202%2022%204%2022%208V13C22%2017%2020%2019%2016%2019H15.5C15.19%2019%2014.89%2019.15%2014.7%2019.4L13.2%2021.4C12.54%2022.28%2011.46%2022.28%2010.8%2021.4L9.3%2019.4C9.14%2019.18%208.77%2019%208.5%2019Z'%20stroke='%23909090'%20stroke-width='1.5'%20stroke-miterlimit='10'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M7%208H17'%20stroke='%23909090'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M7%2013H13'%20stroke='%23909090'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e";function te(){const t=v(),{isPending:u,mutateAsync:n}=g({mutationKey:["delete-thread"],mutationFn:async s=>(await h.delete(`/threads/${s}`)).data,onError:s=>{var a;if(m(s))return c.create({title:(a=s.response)==null?void 0:a.data.message,type:"error"});c.create({title:"Something went wrong!",type:"error"})},onSuccess:async s=>{await t.invalidateQueries({queryKey:["threads"]}),c.create({title:s.message,type:"success"})}});async function l(s){await n(s)}return{isPending:u,onSubmit:l}}const ie=t=>{const{threadId:u}=t,{isPending:n,onSubmit:l}=te(),s=async a=>{a.stopPropagation(),await l(u)};return e.jsxs(M,{motionPreset:"slide-in-top",children:[e.jsx(Q,{asChild:!0,children:e.jsx(x,{variant:"outline",color:"fg.error",rounded:"4xl",children:"delete"})}),e.jsxs(E,{children:[e.jsx(R,{}),e.jsx($,{children:e.jsxs(N,{children:[e.jsx(z,{alignItems:"center",justifyContent:"end",px:"4",asChild:!0,children:e.jsx(O,{size:"sm"})}),e.jsx(V,{children:e.jsx(_,{children:"Delete Thread Confirmation"})}),e.jsx(W,{children:e.jsx(o,{textStyle:"md",children:"Do you want to delete this content?."})}),e.jsxs(Y,{children:[e.jsx(Z,{asChild:!0,children:e.jsx(x,{variant:"outline",children:"Cancel"})}),e.jsx(x,{bg:"fg.error",loading:n,onClick:s,children:"delete"})]})]})})]})]})};function he({thread:t,...u}){var f,j,y,w,k;const{user:n}=G(),l=H(),s=v();function a(){l(`/detail/${t.id}`)}const{isPending:D,mutateAsync:S}=g({mutationKey:["like"],mutationFn:async i=>(await h.post("/likes",i)).data,onError:i=>{var r;if(m(i))return c.create({title:(r=i.response)==null?void 0:r.data.message,type:"error"});c.create({title:"Something went wrong!",type:"error"})},onSuccess:async()=>{await s.invalidateQueries({queryKey:["threads"]})}}),{isPending:I,mutateAsync:P}=g({mutationKey:["unlike"],mutationFn:async i=>(await h.delete(`/likes/${i.threadId}`)).data,onError:i=>{var r;if(m(i))return c.create({title:(r=i.response)==null?void 0:r.data.message,type:"error"});c.create({title:"Something went wrong!",type:"error"})},onSuccess:async()=>{await s.invalidateQueries({queryKey:["threads"]})}});async function T(i){await S(i)}async function b(i){await P(i)}function L(){var i,r;if((n==null?void 0:n.id)!==((i=t.user)==null?void 0:i.id)){const A=(r=t.user)==null?void 0:r.id;l(`/profile/${A}`)}else l("/profile")}return e.jsx(d,{...u,children:e.jsxs(d,{display:"flex",gap:"16px",px:"40px",py:"20px",w:"full",children:[e.jsx(q,{name:((f=t.user)==null?void 0:f.profile.fullName)||"",src:((j=t.user)==null?void 0:j.profile.avatarUrl)??"",shape:"full",size:"full",width:"50px",height:"50px"}),e.jsxs(d,{display:"flex",flexDirection:"column",gap:"4px",flex:"3",children:[e.jsxs(d,{display:"flex",justifyContent:"space-between",children:[e.jsxs(J,{gap:"4px",alignItems:"center",onClick:L,cursor:"pointer",children:[e.jsx(o,{fontWeight:"bold",textStyle:"md",color:"white",children:(y=t.user)==null?void 0:y.profile.fullName}),e.jsxs(o,{textStyle:"sm",color:"text.light",children:["@",(w=t.user)==null?void 0:w.username]}),e.jsx(o,{color:"white",children:"â€¢"}),e.jsx(o,{color:"white",textStyle:"sm",children:B(t.createdAt)})]}),e.jsx(C,{justifySelf:"flex-end",alignItems:"end",children:e.jsxs(X,{when:((k=t.user)==null?void 0:k.id)===(n==null?void 0:n.id),children:[e.jsx(ie,{threadId:t.id}),e.jsx(F,{thread:t})]})})]}),e.jsxs(d,{w:"full",flexDir:"column",justifyContent:"center",alignItems:"start",display:"flex",spaceY:5,children:[e.jsx(o,{cursor:"pointer",onClick:a,color:"white",children:t.content}),e.jsx(p,{src:t.images,rounded:"4xl",maxH:"300px",w:"100%",objectFit:"cover"})]}),e.jsxs(d,{display:"flex",children:[e.jsxs(x,{variant:"ghost",display:"flex",gap:"4px",_hover:{bg:"initial"},disabled:D||I,onClick:()=>t.isLiked?b({threadId:t.id}):T({threadId:t.id}),children:[e.jsx(p,{src:t.isLiked?K:U,width:"27px"}),e.jsx(o,{color:"white",children:t.likesCount})]}),e.jsx(x,{variant:"ghost",display:"flex",_hover:{bg:"initial"},gap:"4px",children:e.jsxs(C,{cursor:"pointer",onClick:a,gap:"1.5",children:[e.jsx(p,{src:ee,width:"27px"}),e.jsxs(o,{color:"white",children:[t.repliesCount??0," "]}),e.jsx(o,{color:"text.light",children:"Replies"})]})})]})]})]})})}export{he as C};
