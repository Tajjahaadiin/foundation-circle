import{w as U}from"./with-props-BMy_yGDR.js";import{a as o,o as e}from"./chunk-IR6S3I6Y-DmKRdMYR.js";import{s as k}from"./user-search-outline-D94IWncY.js";import{G as q,A as G,u as z}from"./avatar-BJvGI2je.js";import{a as M}from"./create-recipe-context-GxxJYqGB.js";import{I as N,a as $}from"./api-C3WgiByt.js";import{u as L,U as K}from"./use-unfollow-BjTJYNLn.js";import{B as m}from"./box-Dg76m1IB.js";import{T as x}from"./text-DPDxdRnU.js";import{B as Q,l as X}from"./QueryClientProvider-Y79vg6s4.js";import{I as _}from"./input-coGY6x29.js";import"./query-CfEU5IWo.js";import"./js.cookie-Cz0CWeBA.js";import"./authStore-BusQRGVs.js";import"./index-BfRFUK5P.js";const W=M("div",{base:{display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",zIndex:2,color:"fg.subtle",height:"full",fontSize:"sm",px:"3"},variants:{placement:{start:{insetInlineStart:"0"},end:{insetInlineEnd:"0"}}}}),H=o.forwardRef(function(t,i){const{startElement:d,startElementProps:n,endElement:s,endElementProps:l,children:u,startOffset:c="6px",endOffset:p="6px",...w}=t,h=o.Children.only(u);return e.jsxs(q,{ref:i,...w,children:[d&&e.jsx(W,{pointerEvents:"none",...n,children:d}),o.cloneElement(h,{...d&&{ps:`calc(var(--input-height) - ${c})`},...s&&{pe:`calc(var(--input-height) - ${p})`},...u.props}),s&&e.jsx(W,{placement:"end",...l,children:s})]})});function J(r,t,i){var d=this,n=o.useRef(null),s=o.useRef(0),l=o.useRef(null),u=o.useRef([]),c=o.useRef(),p=o.useRef(),w=o.useRef(r),h=o.useRef(!0);w.current=r;var F=typeof window<"u",j=!t&&t!==0&&F;if(typeof r!="function")throw new TypeError("Expected a function");t=+t||0;var C=!!(i=i||{}).leading,R=!("trailing"in i)||!!i.trailing,g="maxWait"in i,P="debounceOnServer"in i&&!!i.debounceOnServer,S=g?Math.max(+i.maxWait||0,t):null;o.useEffect(function(){return h.current=!0,function(){h.current=!1}},[]);var B=o.useMemo(function(){var E=function(a){var f=u.current,b=c.current;return u.current=c.current=null,s.current=a,p.current=w.current.apply(b,f)},v=function(a,f){j&&cancelAnimationFrame(l.current),l.current=j?requestAnimationFrame(a):setTimeout(a,f)},T=function(a){if(!h.current)return!1;var f=a-n.current;return!n.current||f>=t||f<0||g&&a-s.current>=S},A=function(a){return l.current=null,R&&u.current?E(a):(u.current=c.current=null,p.current)},I=function a(){var f=Date.now();if(T(f))return A(f);if(h.current){var b=t-(f-n.current),O=g?Math.min(b,S-(f-s.current)):b;v(a,O)}},y=function(){if(F||P){var a=Date.now(),f=T(a);if(u.current=[].slice.call(arguments),c.current=d,n.current=a,f){if(!l.current&&h.current)return s.current=n.current,v(I,t),C?E(n.current):p.current;if(g)return v(I,t),E(n.current)}return l.current||v(I,t),p.current}};return y.cancel=function(){l.current&&(j?cancelAnimationFrame(l.current):clearTimeout(l.current)),s.current=0,u.current=n.current=c.current=l.current=null},y.isPending=function(){return!!l.current},y.flush=function(){return l.current?A(Date.now()):p.current},y},[C,g,t,S,R,j,F,P]);return B}function V(r,t){return r===t}function Y(r,t,i){var d=V,n=o.useRef(r),s=o.useState({})[1],l=J(o.useCallback(function(c){n.current=c,s({})},[s]),t,i),u=o.useRef(r);return d(u.current,r)||(l(r),u.current=r),[n.current,l]}function Z({searchUserData:r,...t}){const{isPending:i,onFollow:d}=L(),{isPending:n,onUnFollow:s}=K();return e.jsxs(m,{p:"20px",display:"flex",gap:"16px",borderBottom:"3px solid",borderColor:"bdr",...t,children:[e.jsx(G,{name:r.profile.fullName||"",src:r.profile.avatarUrl||"",shape:"full",size:"full",width:"50px",height:"50px"}),e.jsxs(m,{display:"flex",flexDirection:"column",gap:"4px",flex:"10",children:[e.jsx(x,{fontWeight:"bold",color:"white",children:r.profile.fullName}),e.jsxs(x,{color:"text.light",children:["@",r.username]}),e.jsx(x,{children:r.profile.bio||""})]}),e.jsx(Q,{variant:"outline",alignSelf:"end",bg:"none",color:"white",borderWidth:"1px",borderColor:"white",rounded:"full",alignItems:"center",flex:"3",disabled:i||n,onClick:()=>r.isFollowing?s({followedId:r.id}):d({followedId:r.id}),children:e.jsx(x,{textStyle:"xs",color:"white",children:r.isFollowing?"Unfollow":"Follow"})})]})}function D(){const[r,t]=o.useState(""),[i]=Y(r,500);function d(c){t(c.target.value)}const{data:n,isLoading:s,isFetched:l,refetch:u}=z({queryKey:["search-users"],queryFn:async()=>{const c=await $.get(`/users/search?q=${i}`);return console.log("search",c.data),c.data}});return o.useEffect(()=>{u()},[i,u]),e.jsxs(m,{children:[e.jsx(H,{px:"20px",pt:"40px",width:"100%",spaceX:4,color:"white",startElement:e.jsx(N,{src:k,width:"20px",mx:"3"}),children:e.jsx(_,{placeholder:"Username",borderRadius:"xl",border:"2px solid",bg:"bdr",_focus:{borderColor:"brand.solid"},onChange:d})}),s&&e.jsx(m,{display:"flex",h:"dvh",alignItems:"center",justifyContent:"center",children:e.jsx(X,{})}),l&&e.jsx(e.Fragment,{children:(n==null?void 0:n.length)!==0?e.jsx(e.Fragment,{children:n==null?void 0:n.map(c=>e.jsx(Z,{searchUserData:c},c.id))}):e.jsxs(m,{textAlign:"center",display:"flex",flexDir:"column",h:"dvh",justifyContent:"center",children:[e.jsxs(x,{textStyle:"lg",fontWeight:"bold",color:"white",children:['No result for "',i,'"']}),e.jsx(x,{textWrap:"wrap",textStyle:"md",color:"white",children:"Try Searching For Something else or check the spelling that you typed"})]})})]})}const xe=U(function(){return e.jsx(m,{children:e.jsx(D,{})})});export{xe as default};
